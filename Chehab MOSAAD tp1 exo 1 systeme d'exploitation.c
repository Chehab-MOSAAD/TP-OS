#include <stdlib.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <unistd.h>
#include <stdio.h>

int info_process(void) {

    printf("L'identifiant du processus est %d \n", (int) getpid()) ;
    printf("L'identifiant du processus parent est %d \n", (int) getppid()) ;
    printf("L'identificateur du groupe de processus auquel appartient le processus courant est %d \n", (int) getpgrp()) ;
    printf("Le login de l'utilisateur qui utilise le processus est %s \n", getlogin()) ;
    printf("L'identificateur de l'utiliseur proprietaire du processus courant est %d \n", (int) getuid()) ;
    printf("L'identificateur du groupe d'utilisateurs du proprietaire du processus courant est %d \n", (int) getgid()) ;

    return 0;
}

int main (void){
    int successeur = getpid();
    int pid_fils, fils_termine, circonstance;
    int i;

    pid_fils = fork();

    if (pid_fils == -1){
        perror("fork");
        exit(1);
    }

    else if (!pid_fils){
        printf("je suis le fils %d !\n", getpid());
        info_process();
        printf("\n");
        exit(3);
    }
    while((fils_termine = wait (& circonstance)) != -1){
        sleep(5);
        printf("je suis le pere %d !\n", getpid());
        info_process();
        printf("\n");
        printf("Mon fils %d est termine avec le code %d. \n", fils_termine, WEXITSTATUS(circonstance));
        printf("J'ai termine ! \n");
    exit(0);
    }
    exit(0);
}
